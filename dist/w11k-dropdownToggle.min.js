/**
 * w11k-dropdownToggle - v0.1.0 - 2014-03-05
 * https://github.com/w11k/w11k-dropdownToggle
 *
 * Copyright (c) 2014 WeigleWilczek GmbH
 */
"use strict";angular.module("w11k.dropdownToggle",[]),angular.module("w11k.dropdownToggle").directive("w11kDropdownToggle",["$document",function(a){var b,c=function(a){a.stopPropagation()};return{restrict:"A",controller:["$scope","$element",function(d,e){function f(a,b){var c={isPrevented:!1},e={prevent:function(){c.isPrevented=!0}};return angular.isFunction(a)&&(angular.isDefined(b)?d.$apply(function(){a(e)}):a(e)),c}var g=this;g.isOpen=!1;var h;g.shared={},g.open=function(j){var k=!0;if(b&&(k=b.close()),j&&(j.preventDefault(),j.stopPropagation()),g.isOpen===!1&&k){var l=f(g.shared.onOpen,j);l.isPrevented===!1&&(e.parent().addClass("open"),e.parent().bind("click",c),a.bind("click",i),h=d.$on("$locationChangeSuccess",function(){g.close()}),g.isOpen=!0,b=g)}return g.isOpen},g.toggle=function(){g.isOpen?g.close():g.open()};var i=function(){d.$apply(function(){g.close()})};g.close=function(d){if(g.isOpen){var j=f(g.shared.onClose,d);j.isPrevented===!1&&(e.parent().removeClass("open"),e.parent().unbind("click",c),a.unbind("click",i),h(),h=null,g.isOpen=!1,b=null)}return!g.isOpen}}],link:function(a,b,c,d){function e(a){a.open=d.open,a.close=d.close,a.toggle=d.toggle,a.isOpen=function(){return d.isOpen}}var f=function(b){b.preventDefault(),b.stopPropagation(),a.$apply(function(){d.toggle()})};b.bind("click",f);var g=c.$observe("w11kDropdownToggle",function(b){if(angular.isDefined(b)&&""!==b){var c=a.$eval(b);angular.isObject(c)&&(d.shared=c,e(c),g(),g=null)}})}}}]);